 
CREATE TABLE images (
--  owner_id uuid references users(user_id),
  image_id uuid primary key,
  added_timestamp timestamp with time zone,
  img bytea
);

create or replace function img_import(filename text)
  returns void
  volatile
  as $$
    declare
        content_ bytea;
        loid oid;
        lfd integer;
        lsize integer;
    begin
        loid := lo_import(filename);
        lfd := lo_open(loid,131072);
        lsize := lo_lseek(lfd,0,2);
        perform lo_lseek(lfd,0,0);
        content_ := loread(lfd,lsize);
        perform lo_close(lfd);
        perform lo_unlink(loid);

    insert into images values
    (
    uuid_generate_v4(),
    now(),
    content_);
    end;
$$ language plpgsql


select img_import('/home/alex/Documents/Git/bases-dos/scripts/imagenes/foto.png');


-- SQL Error [42501]: ERROR: permission denied for function pg_read_file
-- SQL Error [42501]: ERROR: could not open server file "/home/alex/Documents/Git/bases-dos/scripts/imagenes/foto.png": Permission denied
  Where: PL/pgSQL function img_import(text) line 8 at assignment
